<scene_renderer_commands>
    <!--pre_render-->
	<render_command filename="../CommonData/pre_render_cmd.xml"/>
	
    <disable_z_write/>
    <disable_z_test/>
    
	<set_pool_renderable_objects_technique pool="init_deferred_technique_pool_renderable_object_technique"/>
    <render_draw_quad active="true">
        <texture stage_id="0" name="LightMapTexture"/>
    </render_draw_quad>
	
	<enable_alpha_blend/>
	<set_blend srcblend="One" dstblend="One" blendop="Add"/>
	
	<set_pool_renderable_objects_technique pool="render_deferred_technique_pool_renderable_object_technique"/>
    <render_deferred_shading>
        <texture stage_id="0" name="DiffuseMapTexture"/>
        <texture stage_id="1" name="LightMapTexture"/>
        <texture stage_id="2" name="NormalMapTexture"/>
        <texture stage_id="3" name="DepthMapTexture"/>
    </render_deferred_shading>
	
	<enable_z_test/>
	<enable_alpha_blend/>
	<set_blend srcblend="One" dstblend="One" blendop="Add"/>
	<render_billboards/>
	<!--<render_editors/>-->
	<render_triggers/>
	<render_gizmos render="true"/>
	<render_process/>
	
	<disable_alpha_blend/>
	<disable_z_test/>

	<render_command filename="../CommonData/glow_cmd.xml"/>
	
	<disable_alpha_test/>
	
	<enable_alpha_test/>
	<set_pool_renderable_objects_technique pool="lens_flare_pool_renderable_object_technique"/>
    <render_draw_quad active="false" name="InsideBarrel">
 		<texture stage_id="0" name="Data/textures/InsideBarrel.png"/>
 	</render_draw_quad>
	<disable_alpha_test/>
	
	<set_pool_renderable_objects_technique pool="lens_flare_pool_renderable_object_technique"/>
    <render_weapon_target size="20">
 		<texture stage_id="0" name="Data/textures/mirilla.png"/>
 	</render_weapon_target>
    
    <postproc filename="../CommonData/Scene_Renderer_Commands_Post_Proc/Scene_Renderer_Command_ColorGrading.xml"/>
    <!--postproc filename="../CommonData/Scene_Renderer_Commands_Post_Proc/Scene_Renderer_Command_LightScattering.xml"/-->
	
	<enable_z_test/>
	<enable_alpha_blend/>
	<set_blend srcblend="SrcAlpha" dstblend="InvSrcAlpha" blendop="Add"/>
	<render_particules/>
	<render_billboards/>
    
    SCATTERED_LIGHT_START
    <capture_frame_buffer name="FB1">
		<dynamic_texture stage_id="0" name="FB1" texture_width_as_frame_buffer="true" format_type="A8R8G8B8"/>
	</capture_frame_buffer>

    <scattered_light>
        <texture stage_id="0" name="FB1"/>
    </scattered_light>
    SCATTERED_LIGHT_END
	
	<!-- Rendering Lens Flares -->
	<enable_alpha_blend/>
	<set_blend srcblend="One" dstblend="One" blendop="Add"/>
	<lens_of_flare/>
	<disable_alpha_blend/>
	
	<disable_z_test/>
    
	<enable_alpha_blend/>
	<set_blend srcblend="SrcAlpha" dstblend="InvSrcAlpha" blendop="Add"/>
	<render_gui render="true"/>
	<disable_alpha_blend/>
	
	<render_developer_info/>
    <end_scene/>

    <present/>
</scene_renderer_commands>
